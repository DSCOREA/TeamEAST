<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="x-ua-compatible" content="ie=9" />
    <title>Primescan Configuration Suite v1.3 [Team EAST]</title>
    <style>
        html { font-size: 10px; }
        body { font-family: 'Malgun Gothic', '맑은 고딕', sans-serif; margin: 0; padding: 0; background: #eef2f3; color: #333; overflow: hidden; }
        .container { display: flex; width: 100%; height: 100vh; justify-content: center; align-items: center; }
        #content-area { text-align: center; padding: 2rem 0; width: auto; }
        .content-wrapper { display: inline-block; text-align: center; width: auto; }
        .header { margin-bottom: 2rem; }
        .header h1 { font-size: 4.2rem; font-weight: 600; color: #2c3e50; margin: 0 0 0.2em 0; }
        .header p { font-size: 1.8rem; color: #7f8c8d; }

        .card, .btn {
            display: inline-block; vertical-align: top; background-color: #ffffff; border-radius: 1.2rem; padding: 2rem; text-align: center;
            cursor: pointer; border: 1px solid #dcdcdc; box-shadow: 0 0.4rem 1.5rem rgba(0,0,0,0.05);
            transition: all 0.3s ease; margin: 1rem; box-sizing: border-box;
        }
        .card:hover, .btn:hover {
            transform: translateY(-0.8rem); box-shadow: 0 1.2rem 2.5rem rgba(0,0,0,0.1); border-color: #3498db;
        }
        .card-container { white-space: nowrap; }
        .card { width: 42rem; }
        .card h2 { font-size: 2.4rem; font-weight: 600; color: #2c3e50; margin: 0.5em 0; }
        .card p { color: #7f8c8d; font-size: 1.6rem; line-height: 1.5; min-height: 4.8rem; }
        .card-icon { width: 5rem; height: 5rem; margin: 0 auto 1rem auto; }

        .back-button { display: block; margin-top: 2rem; font-size: 1.6rem; color: #3498db; cursor: pointer; text-decoration: none; }
        .back-button:hover { text-decoration: underline; }

        .modal {
            display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.6); justify-content: center; align-items: center;
        }
        .modal-content {
            background: #fff; border-radius: 1.2rem; padding: 3rem; text-align: center; max-width: 60rem; width: 80%;
            box-shadow: 0 0.8rem 2rem rgba(0,0,0,0.2); animation: fadeIn 0.3s ease-out;
        }
        .modal-content h3 { font-size: 2.8rem; font-weight: 600; color: #2c3e50; margin: 0 0 1rem; }
        .modal-content p { font-size: 1.6rem; color: #555; line-height: 1.6; margin-bottom: 2rem; }
        .modal-content .button-group { display: flex; justify-content: center; gap: 1rem; }
        .modal-content button {
            padding: 1.2rem 3rem; font-size: 1.8rem; border-radius: 0.8rem; cursor: pointer; border: none;
            transition: background-color 0.2s ease, transform 0.2s ease;
        }
        .modal-content button.primary { background-color: #3498db; color: white; }
        .modal-content button.primary:hover { background-color: #2980b9; transform: translateY(-0.2rem); }
        .modal-content button.secondary { background-color: #e9ecef; color: #333; }
        .modal-content button.secondary:hover { background-color: #dcdcdc; transform: translateY(-0.2rem); }
        
        .progress-content, .alert-content { background: none; box-shadow: none; max-width: 70rem; }
        .progress-content h3, .alert-content h3 { color: white; font-size: 2.4rem; margin-bottom: 1em; }
        .progress-bar-container { width: 100%; background-color: #f0f0f0; border-radius: 1rem; border: 1px solid #ccc; }
        .progress-bar { width: 0%; height: 3rem; background-color: #3498db; border-radius: 1rem; transition: width 0.1s linear, background-color 0.5s ease; }
        .alert-content button { padding: 1rem 3rem; font-size: 1.8rem; border-radius: 0.8rem; }

        @keyframes fadeIn { from { opacity: 0; transform: translate(-50%, -50%) scale(0.9); } to { opacity: 1; transform: translate(-50%, -50%) scale(1); } }

        #software-list { margin-bottom: 2.5rem; white-space: normal; text-align: center; }
        .software-item { display: block; background-color: #f8f9fa; border: 1px solid #e9ecef; width: 80rem; padding: 1.5rem; margin: 1rem auto; box-shadow: 0 0.2rem 0.5rem rgba(0,0,0,0.05); transition: all 0.2s ease; }
        .software-item:hover { transform: none; box-shadow: 0 0.4rem 1rem rgba(0,0,0,0.1); }
        .software-item h2 { font-size: 2.2rem; margin: 0; width: 100%; }
        .software-item p { font-size: 1.4rem; color: #868e96; margin: 0.4em 0 0 0; }
        .action-grid { margin-top: 1.5rem; width: 80rem; display: inline-block; }
        .action-grid .btn { width: 37rem; height: 10rem; padding: 0; display: inline-flex; justify-content: center; align-items: center; margin: 1rem; }
        .action-grid .btn h2 { font-size: 2.2rem; margin: 0; }
    </style>
    <script>
        document.oncontextmenu = function(){return false;};
        var progressInterval;
        var alertCountdownInterval;
        var isConnectSWInstalled = false;

        var pages = {
            'home': [
                '<div class="content-wrapper">',
                '    <div class="header"><h1>Primescan Configuration Suite v1.3 둘러보기</h1><p>원하는 작업을 선택하여 실행하세요.<br><br><b>DSGO GUI 메인 화면 입니다.<br>만약 백신 경고가 발생하면 Media 폴더에 있는 ExclusionPath를 관리자 권한으로 실행 후 사용하세요.</b></p></div>',
                '    <div class="card-container">',
                '        <div class="card" onclick="showDescriptionModal(\'기본 설정\', \'시스템 최적화 및 개인화 설정을 자동으로 적용합니다. 다음 항목이 포함됩니다.<br><br>1. 시스템 최적화 (코타나, 원드라이브 등 불필요한 서비스 비활성)<br>2. 퍼포먼스 향상 (전원 고성능 및 USB 절전 해제, 덮개 동작 설정)<br>3. 윈도우 보안 설정 (공유권한 설정, UAC, 방화벽, 정보수집 비활성)<br>4. 기타 환경 설정 (표준 시간대, 바탕화면 아이콘 등 바로가기 생성)\', () => runScriptWithProgress(\'TASK_01\', \'기본 설정을 적용하는 중입니다...\'))">',
                '            <svg class="card-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">',
                '               <defs><linearGradient id="iconGradient1" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" /><stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" /></linearGradient></defs>',
                '               <path fill="url(#iconGradient1)" d="M19.4,11.5c-0.2-1.5-1-2.8-2.2-3.7c-0.3-0.2-0.6-0.3-1-0.2l-1.6,0.5c-1.2,0.4-2.5-0.1-3.3-1.1c-1.1-1.3-2.8-2-4.6-1.8 c-1.5,0.2-2.8,1-3.7,2.2C2,8.8,1.6,10.6,1.8,12.3c0.2,1.5,1,2.8,2.2,3.7c0.3,0.2,0.6,0.3,1,0.2l1.6-0.5c1.2-0.4,2.5,0.1,3.3,1.1 c1.1,1.3,2.8,2,4.6,1.8c1.5-0.2,2.8-1,3.7-2.2C21.1,16.2,21.5,14.4,21.4,12.7L19.4,11.5z M12,15.5c-1.9,0-3.5-1.6-3.5-3.5 s1.6-3.5,3.5-3.5s3.5,1.6,3.5,3.5S13.9,15.5,12,15.5z"/>',
                '            </svg>',
                '            <h2>기본 설정</h2><p>시스템 최적화 및 개인화 설정을 일괄 적용합니다.</p>',
                '        </div>',
                '        <div class="card" onclick="loadPage(\'software\')">',
                '            <svg class="card-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">',
                '               <defs><linearGradient id="iconGradient2" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" /><stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" /></linearGradient></defs>',
                '               <path fill="url(#iconGradient2)" d="M21,7H3C2.4,7,2,7.4,2,8v12c0,0.6,0.4,1,1,1h18c0.6,0,1-0.4,1-1V8C22,7.4,21.6,7,21,7z M20,19H4V9h16V19z M17,6H7V4 c0-1.1,0.9-2,2-2h4c1.1,0,2,0.9,2,2V6z M15,6H9V4h6V6z"/>',
                '            </svg>',
                '            <h2>소프트웨어 설치</h2><p>Connect SW 등 관련 프로그램을 설치합니다.</p>',
                '        </div>',
                '        <div class="card" onclick="showDescriptionModal(\'바탕화면 변경\', \'지정된 이미지로 바탕화면을 변경하는 프로그램을 실행합니다.<br>프로그램 창이 열리면 직접 변경 작업을 진행할 수 있습니다.<br><br><b>Dell - 4K 200% 배율 / AC, Lenovo - FHD</b><br>케어 가입 상태로 구분 등록<br><br>4K 바탕화면으로 지정된 경우 자동으로 200% 배율로 조절됩니다.<br>(Tip.정규 배율이 아닌 경우 흐려지거나 일부 아이콘이 투명하게 나옵니다)\', () => showCustomAlert(\'바탕화면 변경 프로그램이 실행됩니다.\', 3))">',
                '            <svg class="card-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">',
                '               <defs><linearGradient id="iconGradient3" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" /><stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" /></linearGradient></defs>',
                '               <path fill="url(#iconGradient3)" d="M20,3H4C2.9,3,2,3.9,2,5v11c0,1.1,0.9,2,2,2h16c1.1,0,2-0.9,2-2V5C22,3.9,21.1,3,20,3z M20,16H4V5h16V16z M14,20H10c-0.6,0-1,0.4-1,1s0.4,1,1,1h4c0.6,0,1-0.4,1-1S14.6,20,14,20z M7,14l2.5-3.01L12,15l3-4l5,5H7z M18,9.5 c-0.8,0-1.5-0.7-1.5-1.5s0.7-1.5,1.5-1.5s1.5,0.7,1.5,1.5S18.8,9.5,18,9.5z"/>',
                '            </svg>',
                '            <h2>바탕화면 변경</h2><p>지정된 이미지로 바탕화면을 변경합니다.</p>',
                '        </div>',
                '    </div>',
                '    <div class="exit-button-wrapper">',
                '        <button class="exit-button" onclick="window.close()">창닫기</button>',
                '</div>'
            ].join(''),
            'software': [
                '<div class="content-wrapper">',
                '    <div class="header"><h1>소프트웨어 설치</h1><p>설치할 프로그램을 목록에서 선택하세요.<br><br></p></div>',
                '    <div id="software-list"></div>',
                '    <div class="action-grid">',
                '        <div class="btn" onclick="showDescriptionModal(\'샘플 데이터 복사\', \'샘플 데이터(홍,길동)를 복사합니다.<br>이미 파일이 존재할 경우 덮어쓰기됩니다.\', ()=> runScriptWithProgress(\'TASK_03\', \'샘플 데이터를 복사하는 중입니다...\'))"><h2>샘플 데이터 복사</h2></div>',
                '        <div class="btn" onclick="showDescriptionModal(\'설치프로그램 및 악세서리 복사\', \'관리에 필요한 자료를 D 드라이브에 복사합니다.<br>(DrPrimescan, 원격지원, 스냅샷, 사용자 메뉴얼 등)\', () => runScriptWithProgress(\'TASK_04\', \'설치프로그램 및 악세서리 복사하는 중입니다...\'))"><h2>설치프로그램 및 악세서리 복사</h2></div>',
                '        <div class="btn" onclick="showDescriptionModal(\'업데이트 차단하기\', \'Windows 업데이트 차단 프로그램을 백그라운드에서 실행합니다.<br>이 기능은 자동으로 적용되며, 별도의 창이 나타나지 않습니다.\', () => showCustomAlert(\'업데이트 차단 기능이 실행되었습니다.\', 3))"><h2>업데이트 차단하기</h2></div>',
                '        <div class="btn" onclick="showDescriptionModal(\'디펜더 비활성화하기\', \'Windows Defender를 비활성화하는 프로그램을 실행합니다.<br>프로그램 창이 열리면 직접 비활성화 작업을 진행할 수 있습니다.\', () => showCustomAlert(\'디펜더 비활성화 프로그램을 실행합니다.\', 3))"><h2>디펜더 비활성화하기</h2></div>',
                '    </div>',
                '    <div class="nav-button-wrapper">',
                '        <button class="nav-button" onclick="showGoHomeModal()">← 메인 메뉴로 돌아가기</button>',
                '</div>'
            ].join('')
        };
        
        // HTA의 파일 목록을 시뮬레이션하기 위한 더미 데이터입니다.
        var dummySoftwareList = [
            { name: "Connect SW 설치하기", version: "버전: 5.2.10.283867.21" },
            { name: "DS Monitor설치하기", version: "버전: 2.1.1.284499" },
        ];
        
        var descriptionModal;
        var descriptionModalTitle;
        var descriptionModalBody;
        var descriptionModalPrimaryBtn;

        document.addEventListener('DOMContentLoaded', function() {
            adjustLayout();
            loadPage('home');
            
            // 모달 요소들을 전역 변수에 할당
            descriptionModal = document.getElementById('description-modal');
            descriptionModalTitle = document.getElementById('modal-title');
            descriptionModalBody = document.getElementById('modal-description');
            descriptionModalPrimaryBtn = document.getElementById('modal-run-btn');
        });

        window.onresize = adjustLayout;

        function adjustLayout() {
            var baseWidth = 1920;
            var screenWidth = window.innerWidth;
            var ratio = screenWidth / baseWidth;
            var newFontSize = 10 * ratio;
            document.documentElement.style.fontSize = newFontSize + 'px';
        }

        function loadPage(pageName) {
            document.getElementById("content-area").innerHTML = pages[pageName];
            if (pageName === 'software') {
                populateSoftwareList();
            }
        }

        function showCustomAlert(message, duration) {
            var modal = document.getElementById('alert-modal');
            var msg = document.getElementById('alert-message');
            var btn = document.getElementById('alert-button');
            msg.innerHTML = message;
            modal.style.display = 'flex';
            var countdown = duration || 5;
            btn.innerHTML = "확인 (" + countdown + ")";
            alertCountdownInterval = setInterval(function() {
                countdown--;
                btn.innerHTML = "확인 (" + countdown + ")";
                if (countdown <= 0) {
                    hideCustomAlert();
                }
            }, 1000);
        }

        function hideCustomAlert() {
            clearInterval(alertCountdownInterval);
            document.getElementById('alert-modal').style.display = 'none';
        }

        function showDescriptionModal(title, description, actionCallback) {
            descriptionModalTitle.innerHTML = title;
            descriptionModalBody.innerHTML = description;
            descriptionModalPrimaryBtn.onclick = function() {
                hideDescriptionModal();
                actionCallback();
            };
            descriptionModal.style.display = 'flex';
        }

        function hideDescriptionModal() {
            descriptionModal.style.display = 'none';
        }

        function runScriptWithProgress(taskID, message) {
            var modal = document.getElementById('progress-modal');
            var msg = document.getElementById('progress-message');
            var bar = document.getElementById('progress-bar');
            
            msg.innerHTML = message;
            bar.style.width = '0%';
            bar.style.backgroundColor = '#3498db';
            modal.style.display = 'flex';
            
            var width = 0;
            progressInterval = setInterval(function() {
                if (width < 95) { width++; bar.style.width = width + '%'; }
            }, 40);
            
            setTimeout(function() {
                clearInterval(progressInterval);
                bar.style.width = '100%';
                bar.style.backgroundColor = '#27ae60';
                
                setTimeout(function() {
                    modal.style.display = 'none';
                }, 500);
            }, 3000); // 3초 후에 작업 완료 시뮬레이션
        }
        
        function populateSoftwareList() {
            var listContainer = document.getElementById('software-list');
            var html = '';
            
            if (dummySoftwareList.length > 0) {
                dummySoftwareList.forEach(function(file) {
                    var displayName = file.name.replace(/_/g, ' ').replace('.exe', '');
                    var description = "파일을 클릭하면 " + displayName + " 시작됩니다.";
                    
                    html += '<div class="btn software-item" onclick="showDescriptionModal(\'' + displayName + '\', \'' + description + '\', () => installSoftware(\'' + file.name + '\'))">';
                    html += '<h2>' + displayName + '</h2>';
                    html += '<p>' + file.version + '</p>';
                    html += '</div>';
                });
            } else {
                html = '<h3>설치할 프로그램이 없습니다.</h3>';
            }
            listContainer.innerHTML = html;
        }

        function installSoftware(fileName) {
            if (fileName.indexOf('Connect') > -1 || fileName.indexOf('Monitor') > -1) {
                // Connect SW, DS Monitor의 경우 특정 메시지 출력
                if (fileName.indexOf('Connect') > -1) {
                    isConnectSWInstalled = true;
                }
                showCustomAlert("설치 시 초기 로딩 시간이 있을 수 있습니다.(특히 Dell)<br>잠시 기다리면 설치가 시작됩니다.", 5);
            } else {
                runScriptWithProgress('TASK_INSTALL_SW', fileName + " 설치를 시작하는 중입니다...");
            }
        }

        function runCopyConnectParams() {
            runScriptWithProgress('TASK_07', 'Connect SW 기본 파라미터를 복사하는 중입니다...');
        }

        function showGoHomeModal() {
             var description = "메인 메뉴로 돌아갑니다.<br>Connect SW가 설치되어 있는 경우,<br>기본 파라미터를 추가로 적용할지 물어보는 안내창이 나타납니다.";
             showDescriptionModal('메인 메뉴로 돌아가기', description, function() {
                goHome();
             });
        }
        
        function goHome() {
            if (isConnectSWInstalled) {
                if (confirm("Connect SW가 설치된 것을 확인했습니다.\n파라미터 정보를 설치 경로에 복사하시겠습니까?")) {
                    runCopyConnectParams();
                }
            }
            loadPage('home');
        }
    </script>
</head>
<body>
    <div class="container">
        <div id="content-area"></div>
    </div>
    
    <div id="progress-modal" class="modal">
        <div class="modal-content progress-content">
            <h3 id="progress-message">작업을 처리하는 중입니다...</h3>
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
        </div>
    </div>

    <div id="alert-modal" class="modal">
        <div class="modal-content alert-content">
            <h3 id="alert-message"></h3>
            <button id="alert-button" class="alert-button primary" onclick="hideCustomAlert()">확인</button>
        </div>
    </div>

    <div id="description-modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title"></h3>
            <p id="modal-description"></p>
            <div class="button-group">
                <button id="modal-run-btn" class="primary">실행</button>
                <button class="secondary" onclick="hideDescriptionModal()">취소</button>
            </div>
        </div>
    </div>
</body>
</html>

